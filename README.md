# üè∞ CASTLE LLM Blue Agent

A training-free Large Language Model (LLM) based cyber defense agent designed for the [CAGE Challenge](https://github.com/CAGE-Challenge). This agent simulates blue-team behavior in a dynamic network environment without any fine-tuning or training, relying solely on prompt engineering and LLM inference.

---

## üöÄ Overview

The CASTLE Blue Agent defends a simulated enterprise network against advanced Red Team attacks by:

- Monitoring and analyzing suspicious activity
- Deploying honeypots to delay attackers
- Restoring compromised systems (with penalty)

The agent operates in a step-by-step simulation loop, observing network states and responding with defensive actions generated by an LLM.

---

## üß† Key Features

- **Training-free**: No fine-tuning or RL training required
- **LLM-powered**: Uses OpenAI GPT models for decision-making
- **Modular prompts**: Fully prompt-driven architecture
- **Reward-aware**: Aligns decisions with a sparse reward function
- **Evaluated in simulation**: Tested on multiple Red agent strategies

---

## üï∏Ô∏è Simulation Environment

The agent runs inside the [CAGE Challenge](https://github.com/CAGE-Challenge/sim) environment.

### Network Topology

- `Subnet 1` - Entry zone
- `Subnet 2` - Server zone
- `Subnet 3` - Operational zone (critical target)

Red agents attempt to compromise Subnet 3 through phishing, privilege escalation, and impact attacks. Blue must stop them.

---

## üì¶ Installation

```bash

pip install -r Requirements.txt
```

You‚Äôll also need access to an OpenAI API key:

```bash
export OPENAI_API_KEY=your_api_key_here
```

---

## ‚öôÔ∏è Usage

To run the agent in the CAGE simulator:

```bash
python llm_agent.py
```

---

## üìù Prompt Structure

The agent uses structured prompts including:

- Observed network state
- Action history
- Time step
- Reward vector
- Available actions

Example prompt:
```
[Observation]
Host: H3 (Subnet 2) shows suspicious lateral movement.
[History]
T4: Blue used MONITOR | T3: Red escalated privileges
[Goal]
Prevent access to Subnet 3.
[Available Actions]
1. ANALYZE(H3) 2. DEPLOY_HONEYPOT(H2) ...
```

---
