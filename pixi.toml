[workspace]
authors = ["klimantas <kevin.limanta.th@dartmouth.edu>"]
channels = ["conda-forge"]
name = "castle-llm"
platforms = ["linux-64"]
version = "0.1.0"

[tasks]
check-blas = "pixi list | grep -i blas"

[dependencies]
python = "3.12.*"
uv = ">=0.9.18,<0.10"
cmake = ">=4.2.1,<5"
paramiko = ">=4.0.0,<5"
pydantic = ">=2.12.5,<3"
# Pretty table for BlueTableWrapper
prettytable = ">=3.17.0,<4"
# Use conda for numpy/scipy to get optimized BLAS on all platforms
numpy = ">=2.4.0,<3"
scipy = ">=1.16.3,<2"
pandas = ">=2.3.3,<3"
matplotlib = ">=3.10.8,<4"
# OpenAI
openai = ">=2.14.0,<3"
gymnasium = ">=1.2.2,<2"
python-dotenv = ">=1.2.1,<2"
# Misc
pyyaml = ">=6.0.3,<7"
ipykernel = ">=7.1.0,<8"
ipywidgets = ">=8.1.8,<9"
tqdm = ">=4.67.1,<5"

[pypi-dependencies]
langchain-dartmouth = ">=0.3.0, <0.4"

# --- LINUX GPU CONFIG ---
[feature.gpu.system-requirements]
cuda = "12.8"

[feature.gpu.target.linux-64.pypi-dependencies]
# torch 2.8.0 pairs with torchvision 0.23.0 and supports CUDA 12.8 (compatible with PyTorch Geometric)
torch = { version = "==2.8.0", index = "https://download.pytorch.org/whl/cu128" }
torchvision = { version = "==0.23.0", index = "https://download.pytorch.org/whl/cu128" }

[feature.gpu.target.linux-64.tasks]
which-vllm = "pixi run python -c 'import vllm; print(vllm.__version__)'"
install-vllm = "uv pip install vllm --torch-backend=auto"

[environments]
gpu = { features = ["gpu"] }
